{% extends 'Home/base.html' %}
{% load static %}

{% block CONTENIDO %}
<div class="container mt-5">
    <h2 class="text-center">0km</h2>

    <!-- Formulario de filtro -->
    <form method="get" class="mb-4 p-4 shadow-sm rounded bg-light">
        <div class="row g-3 justify-content-center">
            <div class="col-md-8">
                <div class="mb-3">
                    <div class="input-group">
                        <span class="input-group-text" id="marca-addon"><i class="bi bi-car-front"></i></span>
                        <select name="marca" id="marca-select" class="form-select text-center" aria-label="Marca" aria-describedby="marca-addon" onchange="this.form.submit()">
                            <option value="" class="text-center">Seleccionar marca</option>
                            {% for marca in marcas %}
                                <option value="{{ marca }}" {% if marca == request.GET.marca %}selected{% endif %}>{{ marca }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="mb-3">
                    <div class="input-group">
                        <span class="input-group-text" id="modelo-addon"><i class="bi bi-car-front-fill"></i></span>
                        <select name="modelo" id="modelo-select" class="form-select text-center" aria-label="Modelo" aria-describedby="modelo-addon" onchange="this.form.submit()">
                            <option value="" class="text-center">Filtrar por modelo</option>
                            {% for modelo in modelos %}
                                <option value="{{ modelo }}" {% if modelo == request.GET.modelo %}selected{% endif %}>{{ modelo }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </form>
    
    <!-- Contenedor de vehículos -->
    <div class="row row-cols-1 row-cols-md-3 g-4">
        {% for vehiculo in vehiculos %}
            <div class="col">
                <div class="card">
                    {% if vehiculo.imagenes.first %}
                        <img src="{{ vehiculo.imagenes.first.imagen.url }}" class="card-img-top" alt="{{ vehiculo.modelo }}">
                    {% else %}
                        <img src="{% static 'images/default_image.jpg' %}" class="card-img-top" alt="Imagen no disponible">
                    {% endif %}
                    <div class="card-body">
                        <h5 class="card-title">{{ vehiculo.marca }} {{ vehiculo.modelo }}</h5>
                        <p class="card-text">Versión: {{ vehiculo.version }}</p>
                        <p class="card-text">Año: {{ vehiculo.año }}</p> <p class="card-text">Kilometraje: {{ vehiculo.kilometraje }} km</p></p>
                        <p class="card-text">Precio: {{ vehiculo.precio }}</p>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
{% endblock %}
